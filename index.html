<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
      var client_id = 'ec737a45-0489-4a31-98fe-bf9e4f676c09'
      var tenant_id = 'e11fd634-26b5-47f4-8b8c-908e466e9bdf'

      function login() {
        var redirect_uri = [location.protocol, '//', location.host, location.pathname].join('')
        var url = 'https://login.microsoftonline.com/' + tenant_id +
        '/oauth2/v2.0/authorize?client_id=' + client_id +
        '&response_type=id_token+token' +
        '&response_mode=fragment' +
        '&scope=' + encodeURI('openid Files.Read') +
        '&redirect_uri=' + encodeURI(redirect_uri) +
        '&nonce=beepboop'

        window.location = url
        return false
      }
    </script>
    <style>
      pre {
        white-space: pre-wrap;
        word-break: break-all;
      }
    </style>
  </head>
  <body>
    <form onsubmit="return login()">
        <input type="submit" value="Get Token" />
    </form>
    <script>
      var hash = window.location.hash
      var token = hash.substring(hash.indexOf("=")+1,hash.indexOf("&"))
      var payload = token.split('.')[1]
      var contents = JSON.parse(atob(payload))

      document.write('<pre>' + JSON.stringify(contents, null, 2) + '</pre>')
      document.write('<pre>' + token + '</pre>')
    </script>
  </body>
</html>
